<html lang="zh-cn" dir="ltr" >
<head data-info="f:msnallexpusers,prg-sp-liveapi,prg-use-camel,ads-sbww-si397-cmb-t,ads-enablesbww-t,ads-senimgv397,ads-siv3,prg-1sw-cusirm,cprg-wpoinfop-log-t3,1s-wpo-viewsinfv3,cprg-wpoinfop-t3,prg-wpo-infop,prg-wpo-noscrl,boost-traffic-ntpf,ntp-boosttraffic-b,ntp-boosttraffic-cm,preprg-1sw-saeecnt,prg-1sw-sa-offv39gt2,prg-1sw-sa-vblv_28d,prg-1sw-saqaatv1,prg-1sw-sa-l4,1s-wpo-pr2-cc-ctr,prg-1sw-sawpol4p2t,prg-cg-notag,prg-1sw-evtp1c-cold,traffic-p1ttstblid-t,prg-1sw-ttstableid,prg-1sw-flwpro,prg-1sw-dicutc3,1s-wpo-prg1-24jrf1113,prg-1sw-shpts,prg-1sw-shpichdr,prg-1sw-sortbtndes,prg-1sw-topsthdr,cg-ntv-shr-hero2-ctr,prg-1sw-mebc8ctr,prg-adspeek,1s-winauthservice,prg-1sw-cgtab-t1,1s-p1-cgtab,flight0417_4,prg-pr2-widget-tab,prg-pr2-cgtab-t3,1s-p2-cgtab,btie-msanrr-t02,1s-fcrypt,1sw-prong1-tr-t2,1s-tpsn-triviaprg,prg-1s-tpsntdc100,prg-1sw-nwpopt,prg-1sw-duprule,prg-1sw-hnopt,prg-1sw-nocd,prg-1sw-nodaucv,prg-1sw-nointcd,prg-1sw-norcap,prg-1sw-noreqcap,prg-1sw-prcaprevt,prg-1sw-prl1rev,prg-1sw-prl2rev,1s-ntf2-exdrc,1s-ntf2-cptyp,1s-ntf2-exdr,prg-upsaip-w1-t,prg-upsaip-r-t,prg-cg-seclarity-c,prg-titlemapping-c,1s-rpssecautht,prg-1sw-p1wtrclm,prg-pr2-smheader5,1s-tpsn-uetimuidprg2-t,1s-tpsn-dimuidprg2,prg-pr2-rcsdlpc,1s-ntf2-rcgaokao,1s-pr2-rcevpreview,1s-rctbrgk,prg-acry-2sm,prg-cm-pkbxcombo,prg-health-staging,1s-tpsn-destattr-c,prg-1sw-satestprod,prg-premier-ntp-t5,1s-preprvd,prg-prm-t18a,1s-ntp-ththeme-tna,1s-tg-ntp-themeexp-tna,1s-wpo-ntp-rvt,prg-scrollherorev,prg-entprem-ntp-c,prg-wolsor,prg-rssn,1s-ntp-crsl-rf5-t1,1s-wpo-tsglprc,prg-1sw-ucscn,ssrntp-nobuf,ssrntp-inmem0k,prg-1sw-wxbgsmr3,prg-1sw-dlysmy,prg-hp-scrct,prg-premier-pr2-rt6,prg-prm-t16,1s-prg-p2-wxlargecd,1s-wpo-pr2-largewea,prg-p2-wxlargecd,1s-pr2-ifsp2s3,1s-wpo-pr2-ifsp2s3,prg-p2-varspinfo,prg-csacclink-c,prg-wx-dhgrd-c,prg-1sw-cprefix,1s-wpo-ntp-wga-c,prg-1sw-sdfuu-ho,prg-auto-igint,prg-atmk-aipoconf,prg-atmk-conf2,prg-atmk-igint,prg-atmk-intconf2,prg-atmk-mygconf5,prg-sh-rmitmlnk,prg-shopping-treat,nopinglancecardit,prg-sh-recopdp,1s-mxr-winfeed-c,mktautosqor,prg-1sw-rr2fn,prg-1sw-rr2fp,prg-strrtng-w1,prg-1sw-wxmptreplace,1s-ntpxapmig,1s-xapcos-fpfwf,1s-xapkaf-ncwf,1s-wpo-ntp-mit1,prg-1s-e-ntpmit1,prg-pr2-sidebar-t,prg-pr2-pagecontext,prg-pr2-shoreline,prg-pr2-sidebar,prg-sh-bd-newchckot,prg-sh-bd-nwchk,prg-cg-ad-ref-if-c,msph-feedinternal,revprmres,1s-temp-wid-t,prg-1s-twid,msph-onboardconfig,prg-spr-bd-ft-c,hp-bot-seo,prg-1sw-wxhurac-c,1i0c7573,fv-spt-staginc,1s-uasdisf-t,ads-payloadredc,ads-creativelog-c,prg-1sw-finvldc,prg-rpt2,prg-cg-dom-clean,ads-anjson-migt,1s-sports-newca,1s-servicetelemetry,sh-bdvid,prg-sh-bd-video,1s-vidconxap-c,1s-wpo-whpfl,prg-1sw-mtr-en-c,msph-contoverview,btie-msancn-hld,1s-wpo-pr2-fl,1s-wpo-mobilfl,prg-flwpro-navctrl,ads-3lift-migr,ads-sharvia-migr,msph-aiacselect,1s-blis-followloc,msph-mngcontrep,msph-c2scontrep,msph-newrsvideo,prg-1sw-iplsdp2,prg-1sw-iplsdp1,prg-1sw-iplsd-ntp,prg-1sw-iplsdc1p2,prg-1sw-iplsdc-ntp,prg-hp-chcontrol,msph-rejectcontent,prg-1sw-actiondata-t,prg-followdata-t,prg-reactdata-t,prg-wx-pwapop,ads-nooutbrain,msph-c2snobrand,prg-1sw-socc-p2,prg-1sw-socc-p1,prg-1sw-socc-ntp,prg-wx-lmap,prg-sp-nba24,prg-sp-nhl24,ads-addlog,prg-hp-ad-layout,prg-ntfc-setting,msph-rtpc2s,msph-videoanalytic,prg-v-nfcoach,1s-xappuse,sh-tpspn-t,prg-sh-artfltd,ads-confiant-bl-m,ads-confiant-bl,msph-c2smanual,prg-ad-light1,ads-appendvideoast-c,prg-cg-ab-testing,msph-defaultux,msph-trendingtopics,prg-1sw-wxrecv2,prg-whp-grtconsist,prg-wx-fs20,msph-videoearning,prg-cg-ad-pod-int,prg-ux-zh-cn,prg-1sw-100authclr,prg-1sw-authclr,prg-1sw-rcux2,prg-1sw-zhcnalt2,prg-vl3,prg-ntpvl3,prg-p2vl3,prg-1sw-reclaim2,prg-1sw-reclaim,1s-xapmwhe2,1s-xappuse2c,1s-xapbnze-p2,1s-xapdube-fp2,1s-xapdube2,1s-p2-bg-appanon,1s-ddosfallback,1s-ddosfallback-m,1s-cgr-l3rbc2,prg-nav-nemt2,prg-nav-nemt,prg-hp-seemoremid,prg-pr2-c-persban,prg-fin-ads,t-cpsbts-cjk-10,prg-chts-mean-10,prg-cpsbts-cjk,1s-ntf1-ifp0cntr,1s-p1-ntf-unfbrn,1s-prg1infocnt0,1s-topstory-p1,1s-wpo-pr1-cgts,prg-hl-rmv,prg-cg-ad-pod-v2,prg-cg-ad-pod;" data-client-settings="{&quot;aid&quot;:&quot;22B691F1F2F04C3C9702A73765B481BD&quot;, &quot;fd_muid&quot;:&quot;04BB019D42306F8E2B7F128943DA6E5C&quot;, &quot;static_page&quot;:&quot;false&quot;, &quot;queryparams&quot;:&quot;?loc=eyJsIjoi5LiK5rW35biCIiwiciI6IuS4iua1t%2BW4giIsImMiOiLkuK3ljY7kurrmsJHlhbHlkozlm70iLCJpIjoiQ04iLCJnIjoiemgtY24iLCJ4IjoiMTIxLjM4NzQ4OTMxODg0NzY2IiwieSI6IjMxLjI4NTIyMzAwNzIwMjE1In0%3D&amp;weadegreetype=C&amp;ocid=msedgntp&amp;cvid=66581f4a382b43799dfa5eb479e2caae&amp;callSsr=true&quot;, &quot;apptype&quot;:&quot;weather&quot;, &quot;pagetype&quot;:&quot;weather::weathertoday&quot;, &quot;configRootUrl&quot;:&quot;https://assets.msn.com/config/v1/&quot;, &quot;feedBaseDomain&quot;:&quot;&quot;, &quot;deviceFormFactor&quot;:&quot;desktop&quot;, &quot;pageGenTime&quot;:&quot;2024-05-30T08:49:37Z&quot;, &quot;pcsInfo&quot;:{&quot;v&quot;:&quot;20240522.1_master&quot;, &quot;env&quot;:&quot;prod-ssr&quot;}, &quot;locale&quot;:{&quot;language&quot;:&quot;zh&quot;, &quot;market&quot;:&quot;cn&quot;, &quot;content&quot;:{&quot;language&quot;:&quot;zh&quot;, &quot;market&quot;:&quot;cn&quot;}, &quot;display&quot;:{&quot;language&quot;:&quot;zh&quot;, &quot;market&quot;:&quot;cn&quot;}}, &quot;featureFlags&quot;:{}, &quot;market&quot;:{ &quot;requestInput&quot;:{ &quot;language&quot;:&quot;zh&quot;,&quot;region&quot;:&quot;cn&quot;, &quot;geo_country&quot;:&quot;CN&quot;}, &quot;detection&quot;:{ &quot;type&quot;:&quot;compliance&quot;,&quot;geo_country&quot;:&quot;&quot;}}, &quot;servicesEndpoints&quot;:{&quot;staticConfig&quot;: {&quot;domain&quot;: &quot;https://assets.msn.cn&quot;, &quot;path&quot;: &quot;/config/v3/&quot;, &quot;v&quot;: &quot;&quot;},&quot;crs&quot;: {&quot;domain&quot;: &quot;https://assets.msn.cn&quot;, &quot;path&quot;: &quot;/resolver/api/resolve/&quot;, &quot;v&quot;: &quot;v3&quot;},&quot;feedService&quot;: {&quot;domain&quot;: &quot;https://assets.msn.cn&quot;, &quot;path&quot;: &quot;&quot;, &quot;v&quot;: &quot;&quot;},&quot;enterpriseFeedService&quot;: {&quot;domain&quot;: &quot;https://ent-api.msn.com/&quot;, &quot;path&quot;: &quot;&quot;, &quot;v&quot;: &quot;&quot;}}, &quot;bundleInfo&quot;:{&quot;v&quot;:&quot;20240529.665&quot;, &quot;alias&quot;:&quot;latest&quot;}, &quot;os&quot;:&quot;windows&quot;, &quot;browser&quot;:{&quot;browserType&quot;:&quot;edgeChromium&quot;, &quot;version&quot;:&quot;125&quot;, &quot;ismobile&quot;:&quot;false&quot;}, &quot;verticalKey&quot;:&quot;weather&quot;, &quot;categoryKey&quot;:&quot;weathertoday&quot;, &quot;domain&quot;:&quot;www.msn.cn&quot;, &quot;ocid&quot;:&quot;msedgntp&quot;, &quot;requestTrailInfo&quot;:{&quot;flightVersion&quot;:&quot;53460718&quot;}, &quot;detection&quot;:{&quot;ip&quot;:&quot;101.80.173.59&quot;}, &quot;geo_country&quot;:&quot;CN&quot;, &quot;geo_countryname&quot;:&quot;China&quot;, &quot;geo_subdivision&quot;:&quot;Shanghai&quot;, &quot;geo_zip&quot;:&quot;201900&quot;, &quot;geo_city&quot;:&quot;Baoshan District&quot;, &quot;geo_lat&quot;:&quot;31.3725&quot;, &quot;geo_long&quot;:&quot;121.4939&quot;, &quot;geo_citycf&quot;:&quot;0&quot;, &quot;geo_countrycf&quot;:&quot;9&quot;, &quot;requestMuid&quot;:&quot;04BB019D42306F8E2B7F128943DA6E5C&quot;}" data-diagnostics="">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta http-equiv="origin-trial" content="An7X35dNCp8wa7sy5tdW7/BBviJ7F5KeD3vDjGgHaznvlFmAPggK2k3jXzBIVMZ6JOlMPOZp5I1q1w+N2MF2tMEAAABseyJvcmlnaW4iOiJodHRwczovL21zbi5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJNc1VzZXJBZ2VudExhdW5jaE5hdlR5cGUiLCJleHBpcnkiOjE3MTk3NzQwMDB9">




    <title>&#x4E0A;&#x6D77;&#x5E02; &#x5929;&#x6C14;&#x9884;&#x62A5; | Microsoft &#x5929;&#x6C14;</title>







    <script type="text/javascript" nonce="">
        try {
            window._pageTimings = window._pageTimings || {};
            window._pageTimings["TTJSStart"] = Math.round(performance.now());
        } catch (e) {
            console.error("Error in adding TTJSStart marker");
        }
    </script>

        <script nonce="">
            function getCookieConsentRequired(){return false;}
            window._ssrServiceEntryUrl="/bundles/v1/weather/latest/SSR-service-entry.7a346c4883b4745b6fe5.js";
        </script>

        <script type="text/javascript" id="inlinehead-inline-script" nonce="">
            window["_webWorkerBundle"] = "/bundles/v1/weather/latest/web-worker.3c663248a055a3b1243a.js";
            window["_authCookieName"] = "ace";
            !function(){"use strict";var e={},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}function i(){return!("undefined"==typeof window||!window.document||!window.document.createElement||window.isRenderServiceEnv)}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();let o=new Map;const s=Object.freeze({set(e,t){return o.set(e,t),this},get:function(e,t){let n=o.get(e);return void 0===n&&t&&(n=t(),o.set(e,n)),n},clear(){o.clear()},delete:e=>o.delete(e),has:e=>o.has(e)});const r="__RequestDataInstance__";class a{constructor(e,t){if(this.url=new URL(e.href),this.innerHeight=e.innerHeight,this.devicePixelRatio=e.devicePixelRatio,this.canUseCssGrid=e.canUseCssGrid,this.requestId=e.requestId,this.cookie=e.cookie,this.referer=e.referer,this.userAgent=e.userAgent,this.clientData=e.clientData,this.oneServiceHeaders=function(e){try{if(e)return JSON.parse(e)}catch(e){}}(e.oneServiceHeaders)||{},this.isPssrMode=t,t){const e=c("OSATE",this.cookie),t=!!e&&"1"===e,n=c("OSAT",this.cookie);if(t&&n||!e&&!n)return this.msalAuthReady=!0,void(n&&(this.oneServiceHeaders.Authorization=`Bearer ${n}`));this.msalAuthReady=!1,this.pssrRejectedReason=e&&!t?"interactiveLogin":e&&!n?"missOSAT":"missOSATE"}}static getInstance(){const e=s.get(r);return e||(n.g.TEST_ENV?d({href:"http://localhost:8080/",innerHeight:768,devicePixelRatio:1,canUseCssGrid:!1,requestId:"0",cookie:"",userAgent:"",referer:"",oneServiceHeaders:""}):d({href:"http://localhost:8080/",innerHeight:0,devicePixelRatio:0,canUseCssGrid:!1,requestId:"0",cookie:"",userAgent:"",referer:"",oneServiceHeaders:""}))}static resetInstance(e){const t=new a(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1]);return s.set(r,t),t}}function c(e,t){if(t&&e){const n=new RegExp("\\b"+e+"\\s*=\\s*([^;]*)","i").exec(t);return n&&n.length>1?n[1]:null}return null}const d=a.resetInstance,l=()=>a.getInstance();var u,h;!function(e){e.Anon="ANON",e.AppAnon="APP_ANON",e.Unknown=""}(u||(u={})),function(e){e.AnonCookieExists="ace",e.AppAnonCookieExists="aace"}(h||(h={}));const p="child";function g(e,t){if(e){const n=new RegExp("\\b"+t+"\\s*=\\s*([^;]*)","i").exec(e);return n&&n.length>1?n[1]:null}return null}function w(e){try{if(e)return JSON.parse(e)}catch(e){}return null}var m;!function(e){e.Adult="adult",e.Enterprise="enterprise",e.Kids="kids"}(m||(m={}));const f="prg-";function b(e){const t=f.length,n=[];return e&&e.length&&(e.forEach((e=>{const i=e&&e.trim();i&&i.length>=t&&i.substring(0,t).toLowerCase()===f&&n.push(i.toLowerCase())})),n.sort()),n}function v(e){var t;return document.head.dataset[e]||(null===(t=S())||void 0===t?void 0:t.dataset[e])}let y;function S(){return void 0===y&&(y=document.getElementsByClassName("peregrine-widget-settings")[0]||null),y}const k="Authorization";var A,C;!function(e){e.Presentation="presentation"}(A||(A={})),function(e){e.Unknown="Unknown",e.Portrait="Portrait",e.Landscape="Landscape"}(C||(C={}));var I,_;!function(e){e[e.Undefined=0]="Undefined",e[e.Basic=1]="Basic",e[e.Advanced=2]="Advanced",e[e.Premium=3]="Premium"}(I||(I={})),function(e){e.Init="init",e.Config="config",e.Targeted="targeted",e.Sticky="sticky",e.NoSticky="no_sticky",e.Admin="admin",e.Forced="forced",e.Manual="manual"}(_||(_={}));new Set(["winp0dash","winp1taskbar","winp1taskbarent","winp1taskbardirect","winp1taskbardirectent","winp1taskbarent","winp2juntaskbar","winp2juntaskbarent","winp2","winp2ent","winp2fp","winp2fpent","winp2fptaskbar","winp2fptaskbarent","winp2fptaskbarhover","winp2fptaskbarhoverent","winp2widget","winp2widgetent"]);const R=new Set(["finance-app-win","weather-app-win","winpstoreapp"]),T=(new Set(["msedgdhp","msedgdhphdr","msedgntphdr","msedgntp","msedgdhp","entnewsntp"]),new Set(["hpmsn"]));function E(){var e;return i()?w(document.head.dataset.clientSettings||(null===(e=document.getElementsByClassName("peregrine-widget-settings")[0])||void 0===e?void 0:e.getAttribute("data-client-settings"))):null}const O="feed/personalize/settings";function q(e,t){const n=t.replace(/[[\]]/g,"\\$&"),i=new RegExp("[?&]"+n+"(=([^&#]*)|&|#|$)").exec(e);if(!i)return null;const o=i[2];return decodeURIComponent(o.replace(/\+/g," "))||""}let N=new class{constructor(){i()?(this.isDebugEnabled=(q(window.location.href,"debug")||"").toLowerCase()in{1:1,true:1}||"vp"===(q(window.location.href,"reqsrc")||"").toLowerCase(),this.isDebugEnabled&&!n.g.TEST_ENV&&(window.webpackRequire=n)):this.isDebugEnabled=!1}getLoggingService(){return null}isDebug(){return this.isDebugEnabled}setDebug(e){this.isDebugEnabled=e}setTags(e){}log(e,t){this.isDebug()&&console.info(e)}logError(e){console.error(e)}logCallback(e){this.isDebug()&&console.info(e())}logObjects(){this.isDebug()&&console.log(...arguments)}logSingleObject(e,t){this.isDebug()&&console.log(e)}};class P{get supported(){return!!this.storage}constructor(e){this.storage=e}getItem(e){if(this.supported)return this.storage.getItem(e)}getObject(e,t){const n=this.getItem(e);if(null!=n){const e=w(n);if(null!=e)return e}return t}key(e){if(this.supported&&e>=0)return this.storage.key(e)}keys(){return this.supported?Object.keys(this.storage):[]}setObject(e,t){void 0!==t?this.setItem(e,JSON.stringify(t)):this.removeItem(e)}removeObject(e){const t=this.removeItem(e);if(null!=t)return w(t)}setItem(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.supported)try{if(!t)throw"Attempted to store null/undefined value: "+t;this.storage.setItem(e,t)}catch(e){if(!n)throw e;N.logError(e)}else if(!n)throw new Error("WebStorage not supported")}get length(){if(this.supported)return this.storage.length}removeItem(e){if(this.supported){const t=this.getItem(e);return this.storage.removeItem(e),t}}clear(){this.supported&&this.storage.clear()}removeSubstringKeys(e){if(!this.supported||!e)return;const t=[];for(let n=0;n<this.storage.length;n++){const i=this.key(n);i&&i.includes(e)&&t.push(i)}for(let e=0;e<t.length;e++)this.removeItem(t[e])}}let x=new class extends P{constructor(){let e=null;if(i())try{e=localStorage}catch(e){}super(e)}};const L="1s-tokens";var M;let W,D,F;function U(){return W=$(),W&&W.accessToken?W:void 0}function H(){if(W=$(),!W)return"notAvailable";const e=W.expiresOn,t=new Date(e),n="expired";if(!t.getTime())return n;return t>new Date?"valid":n}function $(){return W=W||void 0===W&&x.getObject(L)||null,W}function j(e){try{return decodeURIComponent(e)}catch(e){}}function B(e,t){if(!e)return null;if(t)return G(e);if(!F){const e="undefined"!=typeof document&&document.cookie.split("; ");F={};const t=e&&e.length;for(let n=0;n<t;n++){const t=e[n].indexOf("=");F[e[n].slice(0,t).toLocaleLowerCase()]=j(e[n].slice(t+1))}}const n=e.toLocaleLowerCase();return F[n]||null}function G(e){var t;const n=null===(t=document.cookie)||void 0===t?void 0:t.match(`\\b${e}=([^;]*)`);return n?j(n[1]):null}function J(e){const t=B(e);return t&&encodeURIComponent(t)||null}function V(e){let t,n=!1;const i=function(){return n||(n=!0,t=e()),t};return i.cache={clear:()=>{n=!1,t=void 0}},i}!function(e){e.NotAvailable="notAvailable",e.Expired="expired",e.Valid="valid"}(M||(M={}));const z="currentaccount",K=V((()=>{const e=B(z,!0),t=e&&w(e),{login_hint:n}=t||{};return n&&t})),X=V((()=>!!B(z)));function Y(){try{return localStorage}catch(e){return null}}const Q="__PageExperimentInstance__";function Z(e){s.set(Q,e)}function ee(e){if(!s.has(Q)&&i()){var t;Z(te(document.head.dataset.info||(null===(t=window.document.getElementsByClassName("peregrine-widget-settings")[0])||void 0===t||null===(t=t.dataset)||void 0===t?void 0:t.info)||""))}const n=s.get(Q);return n&&n.has(e)}function te(e){const t=(e||"").replace(/(^f:|;.*$)/g,"").split(",");return new Set(t)}const ne="uxlogin",ie="uxlogout",oe="uxedit",se="useRedirect",re="uxswitch",ae=V((()=>{const e=Y();return e&&"1"===e.getItem(ne)||i()&&location.search&&location.search.includes(`${ne}=1`)}));const ce=V((()=>{const e=function(){try{return sessionStorage}catch(e){return null}}();return e&&!!e.getItem(ie)}));const de=V((()=>{const e=Y();return e&&"1"===e.getItem(oe)}));const le=V((()=>{const e=Y(),t=!ee("prg-noredirect")&&e&&"1"===e.getItem(se)&&function(){const e=document.head.dataset.clientSettings||"",{browser:t}=w(e)||{},{browserType:n=""}=t||{};return!!/safari/i.test(n)}();return t}));const ue=V((()=>{const e=Y();return e&&"1"===e.getItem(re)}));const he={outlookMobile:"OnOOutlookMobile",officeMobile:"OnOOfficeMobile",sapphire:"OnOStartApp",skype:"OnOSkype",winWeatherApp:"weather-app-win",xiaomiApp:"xmweather-",launcher:"launcherntp",launcherInterests:"launcherInterests",moto:"moto",swiftKey:"swiftKey",winMoneyApp:"finance-app-win"},pe="superappdhp",ge=["ios","android","ipados"];let we=Ee("ocid").toLowerCase(),me=Ee("chpltfm"),[fe,be]=me.toLowerCase().split("-");function ve(){if(!i())return!1;const e=window.sapphireWebViewBridge,t=window.webkit,n=e&&e.send,o=t&&t.messageHandlers&&t.messageHandlers.send&&t.messageHandlers.send.postMessage;return!(!n&&!o)}function ye(){const e=me&&"outlook"===fe&&ge.includes(be),t=we===he.outlookMobile.toLowerCase();return e||t}function Se(){const e=me&&["office","union"].includes(fe)&&ge.includes(be),t=we===he.officeMobile.toLowerCase();return e||t}function ke(){const e=we===he.skype.toLowerCase()||"skype"===fe;return i()&&(null===(t=window.skypeWebviewBridge)||void 0===t?void 0:t.isSkype)||e;var t}function Ae(){return ve()||we===he.sapphire.toLowerCase()||we===pe.toLowerCase()}function Ce(){const e=Ee("edge");return("emmx"===fe||"1"===e)&&Ae()||"mmx"===we}function Ie(){return"3rdp"===fe||we.startsWith(he.xiaomiApp)||we===he.moto.toLowerCase()||_e()}function _e(){return we.toLowerCase()===he.swiftKey.toLowerCase()||"swiftkey"==fe.toLowerCase()}function Re(){return-1!==location.href.indexOf("huawei")||-1!==location.href.indexOf("airfind")||-1!==location.href.indexOf("aloha")||"vivo"===we&&Ie()}const Te=V((()=>ve()||ke()||Se()||ye()||Ae()||we===he.winWeatherApp.toLowerCase()||we===he.winMoneyApp.toLowerCase()||Ce()||Ie()||[he.launcher.toLowerCase(),he.launcherInterests.toLowerCase()].includes(we)&&Ae()||_e()||Re()||-1!==location.href.indexOf("metaos=true")));function Ee(e){try{return new URL(location.href).searchParams.get(e)||""}catch(e){return""}}const Oe=E()||{},qe={newsAndInterests:1,windowsNewsbar:1,windowsNewsPlus:1,winWidgets:1,windowsShell:1,windowsShellV2:1,distribution:1,superApp:1,channel:1,channeldesktop:1,channelmobile:1,edgeMobile:1},Ne={edgeChromium:1},Pe={winWidgets:1},xe={edgeChromium:1,shopping:1,newsAndInterests:1,windowsNewsbar:1,windowsNewsPlus:1,winWidgets:1,windowsShell:1,windowsShellV2:1},Le={edgeChromium:1,channel:1,channeldesktop:1,channelmobile:1,cgHomePage:1,distribution:1,newsAndInterests:1,windowsNewsbar:1,windowsNewsPlus:1,winWidgets:1,windowsShell:1,windowsShellV2:1,superApp:1,edgeMobile:1},Me=V((()=>Oe&&Oe.apptype)),We=(V((()=>i()&&Me()in Pe)),V((()=>i()&&!Te()&&!(Me()in qe)&&!Ue()&&!He()))),De=V((()=>We()&&!(Me()in Ne)));V((()=>We()&&(!(Me()in Ne)||!X()))),V((()=>We()&&!Ge()&&!Je()));function Fe(){return Je()||Ge()}const Ue=V((()=>{const e=!(Me()in xe)&&Ve()&&function(){const e=new URLSearchParams(i()?window.location.search:l().url.search).get("ocid")||(null==Oe?void 0:Oe.ocid),t=null==e?void 0:e.toLowerCase(),n=!T.has(t)&&"homePage"!==Me()&&!R.has(t);return n}()&&!function(){const e="windows"==Me()&&"windowshp"==(Oe&&Oe.pagetype)&&(i()?window.location.href:l().url.href).includes(`${O}`);return e}();return e})),He=()=>i()&&document&&document.body&&document.body.getElementsByClassName("peregrine-widgets").length>0,$e=V((()=>ee("prg-1s-workid")||ee("prg-1s-sm-workid")||ee("prg-1s-twid")||ee("prg-1s-mm-wid-t")));V((()=>Me()in Le||Ue()));function je(){const e=D;if(e)return N.log("dual-auth: tryGet1SAuthToken returned live tokens"),e;const t=U();if(t)return N.log(`dual-auth: tryGet1SAuthToken returned cached tokens that are ${H()}`),t;N.log("dual-auth: tryGet1SAuthToken returned empty tokens")}function Be(e){const t={};return e&&(t[k]=`Bearer ${e}`),t}function Ge(){return De()&&ae()||function(){const e=De()&&!ae()&&K()&&("expired"==H()||de());return e}()||ce()||le()}function Je(){return De()&&!K()&&ue()}const Ve=V((()=>{const{browser:e}=Oe,{browserType:t="",detected:n={}}=e||{},{browserType:i=""}=n||{};return/edgeChromium/i.test(t)||/edgeAndroid/i.test(t)||/edgeiOS/i.test(t)||/edge/i.test(i)}));V((()=>De()&&!Ue()));const ze="__core_auth_authHeaderPromiseParts__",Ke=()=>s.get(ze);var Xe;!function(){let e;const t={promise:new Promise((t=>e=t)),resolver:e};s.set(ze,t)}(),function(e){e.GLOBAL="GLOBAL",e.GCC_MODERATE="GCC_MODERATE"}(Xe||(Xe={}));let Ye;function Qe(){return Ye}function Ze(e){const t=e||Qe()||"al_app_anon",n=et();return!!(n&&(["anon","al_anon"].includes(t)&&n.AL_ANON||["app_anon","al_app_anon"].includes(t)&&n.AL_APP_ANON))}const et=V((()=>w(B("AL_STATE",!0))));var tt,nt,it;!function(e){e[e.Unknown=0]="Unknown",e[e.NotSignedIn=1]="NotSignedIn",e[e.SignedIn=2]="SignedIn"}(tt||(tt={})),function(e){e.MSA="MSA",e.AAD="AAD",e.UNSUPPORTED_SOVEREIGNTY="UNSUPPORTED_SOVEREIGNTY"}(nt||(nt={})),function(e){e[e.NonAadAccount=0]="NonAadAccount",e[e.AadAccount=1]="AadAccount",e[e.Unknown=2]="Unknown"}(it||(it={}));const ot=()=>{const e=B("elt",!0),t=e&&w(e),{access_token:n,account_type:i,login_hint:o,region_scope:s}=t||{};return(n||i||o||s)&&t};function st(e){if("undefined"==typeof window||!window.document||window.isRenderServiceEnv)return;const t=window.trustedTypes;if(!t||!t.createPolicy)return;const n=window.trustedTypePolicies||(window.trustedTypePolicies={});if(n[e])return n[e];const i=t.createPolicy(e,{createScriptURL:e=>{const t=function(e){const t=["ntp.msn.com","ntp.msn.cn","assets.msn.cn","assets.msn.com","www.bing.com","assets2.msn.com","assets2.msn.cn","www.clarity.ms","int.msn.com","r.bing.com","business.bing.com","staticview.msn.com","staticview.msn.cn",document.location.hostname];let n;try{n=new URL(e,location.origin)}catch(e){return"about:blank#error"}if(n.hostname&&!t.includes(n.hostname))return"about:blank#error";return e}(e);return t}});return n[e]=i,i}class rt{constructor(){this.childCookieName="child",this.domInfo=document.head.dataset.info,this.command="command"}init(e,t){this.clientSettings=e||E(),this.authCookieName=Qe()||window._authCookieName||"",this.bundle=window._webWorkerBundle||"",t=t||{};const n=this.buildWebWorkerUrl(this.clientSettings,t),i=this.clientSettings.apptype;let o;if(i&&"edgeChromium"===i){if(o=this.tryGetWebWorkerUsingPolicy(n,"webWorkerUrlPolicy"),!o)return void console.warn("Error in creating trusted types compliant web worker")}else o=window.webWorker=new Worker(n,{name:"web-worker"});const s=window.webWorkerMessages=[];o.onmessage=e=>{s.push(e.data)};const r=window.webWorkerErrors=[];if(o.onerror=e=>{r.push(e)},window.chrome){const e=this.getAudienceMode(this.clientSettings),t=window.webWorker&&window.chrome&&window.chrome.ntpSettingsPrivate;t&&"function"==typeof t.getPref&&(t.getPref("ntp.news_feed_display",(e=>{e&&e.value&&o.postMessage({id:"FeedDisplaySetting",type:this.command,payload:e.value})})),t.getPref("ntp.layout_mode",(e=>{e&&e.value&&o.postMessage({id:"LayoutModeSetting",type:this.command,payload:e.value})})),t.getPref("ntp.user_nurturing",(e=>{let t=!1;e&&e.value&&e.value.length&&(t=this.getSingleColRequest(e.value)),o.postMessage({id:"RenderSingleColumn",type:this.command,payload:t})})),t.getPref("new_device_fre.has_user_seen_new_fre",(e=>{e&&o.postMessage({id:"NewUserFre",type:this.command,payload:e.value})}))),t&&"function"==typeof t.getConfigData&&t.getConfigData((e=>{const t=(null==e?void 0:e.enabledFeatures)||[];t.includes("msReducedNtpAdsForNewDevice_stage1")&&o.postMessage({id:"EdgeNoAds",type:this.command,payload:!0}),t.includes("msReducedNtpAdsForNewDevice_stage2")&&o.postMessage({id:"EdgeReduceAds",type:this.command,payload:!0})})),e===m.Enterprise&&this.clientSettings.browser&&"edgeChromium"===this.clientSettings.browser.browserType&&parseInt(this.clientSettings.browser.version)>=87?this.getEnterpriseAccessToken().then((e=>{e&&o.postMessage({id:"AuthTokenEnterprise",type:this.command,payload:Be(e)})})):o.postMessage({id:"AuthTokenEnterprise",type:this.command,payload:{}}),e!==m.Adult&&e!==m.Enterprise||this.sendPageConfiguration()}Fe()&&Ke().promise.then((e=>o.postMessage({id:"AuthHeaders",type:this.command,payload:e||{}})))}buildWebWorkerUrl(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return(this.bundle||"")+"#"+this.qsFromDocument()+this.qsFromCookies()+this.qsFromDataAttribute(e||this.clientSettings)+this.qsMisc(t)+this.qsAuth(e||this.clientSettings)+this.qsFromUrl()+this.qsFromServiceWorker()+this.qsSelectedPivot()+this.qsXboxXToken()}qs(e,t,n){return e?t+"="+(n||e)+"&":""}qsFromDocument(){var e;return this.qs(document.getElementsByTagName("html")[0].getAttribute("lang"),"lang")+this.qs(encodeURIComponent(window.location.href),"adsReferer")+this.qs(null===(e=i()?window.devicePixelRatio:l().devicePixelRatio)||void 0===e?void 0:e.toString(),"devicePixelRatio")}qsFromServiceWorker(){if(!navigator.serviceWorker||!navigator.serviceWorker.controller)return"";const e=navigator.serviceWorker.controller;if("activated"!==e.state||!e.scriptURL)return"";if(e.scriptURL){const t=new URL(e.scriptURL).searchParams.toString();return t?"&"+t+"&":""}return""}qsFromCookies(){return this.qs(J(this.authCookieName),"aace","1")+this.qs(J("muid"),"muid")+this.qs(J(this.childCookieName),"child")+this.qs(J("cbypass"),"cbypass")+this.qs(this.cookieBannerConsentRequired().toString(),"ccRequired")+this.qs(J("ecasession"),"ecasession")+this.qs(J("TOptOut"),"browserOptOut")}qsFromDataAttributeHelper(e,t){return e&&e.featureFlags&&e.featureFlags.wpoEnabled&&t&&!t.includes("remwpofltww")&&(t=this.appendWpoFlightsToInfo(e,t)),this.qs(e.pcsInfo&&e.pcsInfo.env||e.env,"env")+this.qs(e.aid,"aid")+this.qs(e.apptype,"apptype")+this.qs(e.pagetype,"pagetype")+this.qs(e.audienceMode,"audienceMode")+this.qs(e.configIndexDocId,"configIndexDocId")+this.qs(e.deviceFormFactor,"deviceFormFactor")+this.qs(e.domain,"domain")+this.qs(e.configRootUrl,"configRootUrl")+this.qs(this.getHighestCbid(e.cbid,e.apptype),"cbid")+this.qs(e.ocid,"ocid")+this.qs(e.os,"os")+this.qs(JSON.stringify(e.locale),"locale")+this.qs(e.geo_lat,"lat")+this.qs(e.geo_long,"long")+this.qs(JSON.stringify(e.featureFlags),"featureFlags")+this.qs(JSON.stringify(e.browser),"browser")+this.qs(JSON.stringify(e.servicesEndpoints),"servicesEndpoints")+this.qs(e.bundleInfo&&e.bundleInfo.v||"","buildVersion")+this.qs(t,"dataInfo")}qsSelectedPivot(){const e="selectedPivot";let t;try{const n=Y();n&&(t=n.getItem(e))}catch(e){console.warn("Error getting pivot id from local storage. "+e)}return this.qs(t,e)}qsXboxXToken(){const e="xboxXTokenId";let t;try{const n=Y();n&&(t=n.getItem(e))}catch(e){console.warn("Error getting xbox XToken from local storage. "+e)}return this.qs(t,e)}appendWpoFlightsToInfo(e,t){const n=this.getWpoFlightsFromLocalStorage(e);if(n&&n.length){const e=";",i=t.split(e);for(let e=0;e<i.length;e++){const t=i[e];if(t&&t.startsWith("f:")){i[e]=t+","+n.join();break}}return i.join(e)}return t}getWpoFlightsFromLocalStorage(e){const t=Y(),n=e.locale,i=`wpo_data_ ${e.audienceMode}_${n.language}_${n.market}_${e.pagetype}_${e.apptype}`;try{const e=t.getItem(i);if(e){return JSON.parse(e).treatments.map((e=>e.id))}}catch(e){console.warn(`Error getting wpo flights from ls for ${i} Error:${e}`)}return null}getHighestCbid(e,t){try{const n=Y(),i=parseInt(e),o=parseInt(JSON.parse(n.getItem(`cbid_${t||""}`)));let s;if(i&&!isNaN(i)&&o&&!isNaN(o)&&(s=i>o?i:o),s=s||i||o,s)return window._cbid=s.toString()}catch(e){console.warn("Error getting highest CBID"+e)}}getAudienceMode(e){Y();const t=B(this.authCookieName),n=B(this.childCookieName),{child:i}=t&&JSON.parse(t)||{};return t&&(1===i||n)?"kids":e.audienceMode||m.Adult}sendPageConfiguration(){const e=this.clientSettings.pagetype;if(e){const t=B&&B("pglt-edgeChromium-"+e);if(t)return void window.webWorker.postMessage({id:"PageConfiguration",type:this.command,payload:t})}window.webWorker.postMessage({id:"PageConfiguration",type:this.command,payload:!1})}qsFromDataAttribute(e){let t,n;const i=Y();if(i){const o=JSON.parse(i.getItem("shd_"+e.pagetype)||null);o&&o.clientSettings&&o.info&&(t={...o.clientSettings,bundleInfo:e.bundleInfo},n=o.info)}return(!t||!n||e.pageGenTime>=t.pageGenTime)&&(t=e,n=this.domInfo),t.audienceMode=this.getAudienceMode(t),this.qsFromDataAttributeHelper(t,n)}qsFromUrl(){const e=location.search;return e&&e.length?e.substring(1,e.length):""}getEnterpriseAccessToken(){return new Promise((e=>{window.chrome&&window.chrome.authPrivate?window.chrome.authPrivate.getPrimaryAccountInfo((t=>{t&&"GCC_MODERATE"!==t.region_scope||e("");const n={account_id:t.account_id,account_type:t.account_type,client_id:"d7b530a4-7680-4c23-a8bf-c52c121d2e87",scope_or_resource:"https://enterprisenews.microsoft.com"};window.chrome.authPrivate.acquireAccessTokenSilently(n,(t=>{t.is_success?e(t.access_token):e("")}))})):e("")}))}qsMisc(e){return this.qs(performance.timeOrigin&&performance.timeOrigin.toString(),"mainTimeOrigin")+this.qs(e.disableWWConfig&&"1","disableWWConfig")}qsAuth(e){let t=this.qs(De()&&"1","disableWWAuth");if(!Fe()){const e=De()&&je()||{};t+=this.qs(encodeURIComponent(JSON.stringify(Be(e.accessToken))),"authHeaders")}return t+=this.qs(Ze()&&"1","isAccountLinked"),t+=this.qs(this.shouldFetchAppAnonCookie()&&"1","fetchAppAnonCookie"),t}getSingleColRequest(e){const t="render_single_column",n="feed_layout";let i,o;for(const s of e){const{key:e,value:r}=s;e===t?i=r:e===n&&(o=r)}return"boolean"==typeof i?i:!!o&&(o&&"single"===o.type)}cookieBannerConsentRequired(){const e=null!=document.getElementById("consent-banner-container")&&null===B("MSCC"),t=null!=document.getElementById("onetrust-sdk")&&null===B("eupubconsent-v2");return e||t}shouldFetchAppAnonCookie(){if(!Ve())return!0;const e=(()=>{const e=ot();if(e){if("MSA"===e.account_type)return nt.MSA;if("AAD"===e.account_type)return nt.AAD}})();return e===nt.MSA||G("lt")?!G("aace"):e===nt.AAD?Ze()&&!$e():void 0}tryGetWebWorkerUsingPolicy(e,t){const n=st(t);if(n){const t=n.createScriptURL(e),i=t&&t.toString();if(!i||"about:blank#error"===i)return;window.webWorker=new Worker(t,{name:"web-worker"})}else window.webWorker=new Worker(e,{name:"web-worker"});return window.webWorker}getFlightList(){return((/^f:\s*([^;]+)/i.exec(this.domInfo)||{})[1]||"").toLowerCase().split(",")}}const at=Object.freeze({AIDRequestHeaderName:"pcs-aid",Product:Object.freeze({edge:"spartan",edgeChromium:"anaheim",hybrid:"spartan",hub:"prime",microsoftNews:"msnews",office:"entnews",weather:"prime",views:"prime"}),PageTimings:Object.freeze({inlineStart:"page.inlineStart",fragmentFetchStart:"ssr.fragmentFetching",fragmentFetchEnd:"ssr.fragmentFetched",fragmentFetchStatusCode:"ssr.fragmentFetchStatusCode",fragmentBrowserCached:"ssr.fragmentBrowserCached",fragmentCDNCached:"ssr.fragmentCDNCached",injectingDOM:"ssr.injectingDOM",awaitingRAF:"ssr.awaitingRAF",markersSet:"ssr.markersSet",completed:"ssr.completed",CSRTimeout:"ssr.CSRTimeout",CSROnly:"ssr.csrOnly",didSSR:"ssr.isSSRPagePresent",riverEnabled:"ssr.riverEnabled",ssrState:"ssr.state",pageTTVR:"TTVR",fetchDelayReason:"ssr.fetchDelayReason",awaitingInnerWidthTime:"ssr.awaitingInnerWidthTime",skipDueToHiddenReason:"ssr.skipDueToHiddenReason",pssrRejectedReason:"ssr.pssrRejected",ssrResponseSize:"ssr.responseSize",inlineBodyStart:"ssr.inlineBodyStart",pcsEnv:"pcsEnv"}),pauseThresholdMS:1200,oneServiceHeaders:"1s-headers",edgeNTPHeader:"sec-edge-ntp",defaultSSRFeedLayout:"multi"});var ct,dt,lt;!function(e){e[e.Hub=0]="Hub",e[e.Homepage=1]="Homepage",e[e.Edge=2]="Edge",e[e.Weather=3]="Weather",e[e.Finance=4]="Finance",e[e.Community=5]="Community",e[e.Views=6]="Views",e[e.Gaming=7]="Gaming",e[e.Sports=8]="Sports",e[e.Health=9]="Health",e[e.Shopping=10]="Shopping",e[e.CgHomePage=11]="CgHomePage"}(ct||(ct={})),function(e){e[e.documentHidden=0]="documentHidden",e[e.hasPaused=1]="hasPaused",e[e.invalidInnerWidth=2]="invalidInnerWidth",e[e.slowFetchStart=3]="slowFetchStart"}(dt||(dt={})),function(e){e.JSON="application/json;charset=UTF-8",e.HTML="text/html;charset=UTF-8"}(lt=lt||(lt={}));function ut(){return i()?window._pageTimings||(window._pageTimings={}):s.get("__diagnostics_pageTimings",(()=>({})))}function ht(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:performance.now(),n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=ut();e in i||(i[e]=n?Math.round(t):t)}function pt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];window.performance.mark(e),t&&ht(e)}let gt,wt,mt;function ft(){if(wt)return wt;const e=document.head.getAttribute("data-info");return wt=((/f:\s*([^;]+)/i.exec(e)||{})[1]||"").toLowerCase(),wt}var bt;!function(e){e[e.Alert=0]="Alert",e[e.NoAlert=1]="NoAlert",e[e.HighImpact=2]="HighImpact",e[e.Critical=3]="Critical"}(bt||(bt={}));const vt=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;this.maxLength=20,this.list=[],this.maxLength=e}push(e){this.list.push(e),this.list.length>this.maxLength&&this.list.shift()}get data(){return this.list}};function yt(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:bt.Alert,o=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0;try{if(s&&(r=10,!(Math.floor(101*Math.random())<=r)))return;const a=function(){if(!gt){const e=document.head.getAttribute("data-client-settings");e&&(gt=JSON.parse(e))}return gt}(),c=ft(),d=function(e){if(e){const{pcsInfo:t,pageGenTime:n}=e,i=new Date(n).getTime(),o=!t||["prod","prod-ssr","prod-ssrntp"].includes(t.env);mt=o?"browser.events.data.msn.com":"events-sandbox.data.msn.com";return{cors:"true","content-type":"application/x-json-stream","client-id":"NO_AUTH","client-version":"1DS-Web-JS-2.2.2",apikey:o?"0ded60c75e44443aa3484c42c1c43fe8-9fc57d3f-fdac-4bcf-b927-75eafe60192e-7279":"f8857dedc6f54ca8962cfb713e01e7d7-e9250191-fe0b-446f-95ae-07516262f98c-7028","upload-time":i,w:"0",anoncknm:"app_anon"}}return null}(a);let l="";d&&d.apikey&&""!==d.apikey&&(l=function(e){if(e){const t=e.indexOf("-");if(t>0)return e.substring(0,t)}return""}(d.apikey));const u=function(e,t,n,i,o,s){let r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:bt.Alert;if(n){o=o||{};const{apptype:c,audienceMode:d,pagetype:l,pageGenTime:u,bundleInfo:h,deviceFormFactor:p="",fd_muid:g,os:w}=n;o.pageGenTime=u,o.build=h&&h.v,o.appType=c;const m=function(e,t,n){const i=n&&"phone"===n.toLowerCase(),o=t&&"enterprise"===t;return{bingHomepage:"binghomepage",mmx:"emmx",edge:"spartan",edgeChromium:o?"entnews":"anaheim",hybrid:"spartan",hub:i?"prime_mobile":"prime",microsoftNews:"msnews",office:"entnews",views:i?"prime_mobile":"prime",windowsShell:"windowsshell"}[e]}(c,d,p),f=m||c,b=document.getElementsByTagName("html")[0].getAttribute("lang");let v,y="",S="muid";try{if("edgeChromium"===c&&"object"==typeof window&&window.location&&window.location.search){const e=new URLSearchParams(window.location.search);v=e.has("startpage")?"msedgdhp":"msedgntp","enterprise"===d?v="entnewsntp":"xbox"===w&&(v="xboxntp")}window&&window.getCookieConsentRequired&&"function"==typeof window.getCookieConsentRequired&&window.getCookieConsentRequired()||(y=B("muid"))}catch{}y||(y=n.aid,S="aid");const k={name:"MS.News.Web.AppError",time:u,ver:"4.0",iKey:`o:${i}`,data:{baseData:{},baseType:"MS.News.Web.Base",page:{name:"default",product:f,type:St(l),content:{category:"standaloneError"},ocid:v},browser:{clientId:y,clientIdType:S},flight:{id:s},request:{activityId:n.aid,requestId:n.aid,afdMuid:g},locale:{mkt:b},extSchema:{id:e,severity:r,pb:o,message:t}}};var a;if(y&&"muid"===S)k.ext={...null==k?void 0:k.ext,user:{...null==k||null===(a=k.ext)||void 0===a?void 0:a.user,localId:`t:${y}`}};return k.data.flight.tmpl="",o.isSSRScope&&(k.data.flight.tmpl+="ssrscope:1"),"object"==typeof window&&(window.isSSREnabled&&(k.data.flight.tmpl+=";ssr-enabled:1"),window.isSSRCompleted&&(k.data.flight.tmpl+=";ssr-completed:1")),k?JSON.stringify(k):null}return null}(t,e,a,l,n,c,i);if(d&&u){console.error(u),vt.push(u);const e="https://"+mt+"/OneCollector/1.0"+function(e){return"?"+Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")}(d);if(o&&!performance.getEntriesByType("visibility-state").some((e=>"visible"===e.name))){const t=()=>{"visible"===document.visibilityState&&navigator.sendBeacon(e,u)};document.addEventListener("visibilitychange",t,{once:!0})}else navigator.sendBeacon(e,u)}}catch{}var r}function St(e){let t=e;switch(e){case"windowsshellhp":t="dhp";break;case"video":t="watch"}return t}const kt="visibilitychange";function At(){return"visible"===document.visibilityState?Promise.resolve():new Promise((e=>{document.addEventListener(kt,(()=>{"visible"===document.visibilityState&&e()}))}))}function Ct(e){const t=window&&window.chrome&&window.chrome.ntpSettingsPrivate;t&&t.logLoadingError&&At().then((()=>{t.logLoadingError(e)}))}function It(e){return new Promise((t=>setTimeout(t,e)))}pt(at.PageTimings.inlineStart,!0);const{inlineCRS:_t}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};try{var n;if(!i())return t;const{all:o,prg:s}=function(){const e=v("info"),t=(e&&e.match(/f:\s*([^;]+)/i)||[])[1]||"",n=t.split(",");return{all:n,prg:b(n)}}(),r=w(v("clientSettings"))||{},a=null===(n=r.apptype)||void 0===n?void 0:n.toLocaleLowerCase(),c=e.crsOptions||{};"winwidgets"===a&&(c.crsPrefetch=!0);(c.crsPrefetch||o.includes("inlinecrscall")||o.includes(`icrscall-${a}`))&&(!function(e,t,n){const o=function(e,t){let n;const i=decodeURIComponent(g(e,"aace")),{child:o}=i&&w(i)||{},s=g(e,p);return n=i&&(1===o||s)?m.Kids:t.audienceMode||m.Adult,n}(document.cookie,e),{apptype:s,browser:r,domain:a="",bundleInfo:{v:c}={},deviceFormFactor:d="",locale:{content:u,display:h}={},ocid:f,os:b="",pagetype:v="",servicesEndpoints:{crs:y}={}}=e,k=(S()?i()?window.location.hostname:l().url.hostname:a)||"";if(!s||!c||!y)return;const A={audienceMode:o,browser:r,deviceFormFactor:d,domain:k,locale:{content:u,display:h},ocid:f,os:b,platform:"web",pageType:v,pageExperiments:t},C=new URLSearchParams([["expType","AppConfig"],["expInstance","default"],["apptype",s],["v",c]]),I=`${y.path}${y.v}/config/?${C}&targetScope=${JSON.stringify(A)}`,_=e=>{const t=new URL(`https://${e}${I}`),{timeout:i=5e3}=n;let o;if(window.crsRequestData={url:t.toString()},i>=0){const e=new AbortController;setTimeout((()=>e.abort()),i),o=e.signal}return fetch(t,{signal:o})},R="msn."+(function(e,t){return!!(e.hostname.toLowerCase().endsWith(".cn")||t.isChinaCompliance||t.useCnDomain||e.search.match(/item=revip:cn/))}(location,e)?"cn":"com"),{domain:T}=y,E=T&&new URL(T).host;let O=_(E||`assets.${R}`);n.disableFallback||(O=O.catch((()=>{const{hostname:e}=location,t=e.match(/\.msn\.(com|cn)$/)?e:`www.${R}`;return _(t)})));window.crsPromise=O}(r,s,c),t.inlineCRS=!0)}catch(e){console.error("InlineHeadCommon: "+e)}return t}(),Rt=E();function Tt(e){var t;return((null===(t=document)||void 0===t||null===(t=t.head)||void 0===t||null===(t=t.getAttribute("data-info"))||void 0===t?void 0:t.split(";").find((e=>e.startsWith("f:"))))||"").includes(e)}window._clientSettings=Rt,Tt("prg-wx-nowebworker")||(new rt).init(Rt,{disableWWConfig:_t}),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["vendors","common","microsoft"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error when loading bundle(s): ",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e5,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;At().then((()=>{setTimeout((()=>{const n=window.webpackJsonp;if(n){const s=n.length,r=e.length+1;if(s<r){if(s===r-1)e=["experience"];else{n.slice(0,r).forEach((t=>{t.length&&t[0][0]&&e.splice(e.indexOf(t[0][0]),1)}))}Ct(20202),yt(t+e.toString(),20202,{}),o&&(Ct(i),o(i,{customMessage:e.toString()}))}}}),n)}))}(),Tt("prg-wx-psdawc")&&async function(){window.apntag=window.apntag||{anq:[]},window.apntag.anq=window.apntag.anq||[],await async function(e){if(!i())return;const{src:t,id:n,async:o=!0,container:s=document.head,retryNumber:r=0,retryDelayMs:a=0}=e;try{await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;if(t<=1)return e();let i,o=1;do{try{i=await e()}catch(e){if(o===t)throw e&&e.message&&(e.message=`${e.message} after ${o} attempts`),e;await It(n)}}while(!i&&++o<=t);return i}((()=>function(e,t,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise(((s,r)=>{const a=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"anonymous",s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0;if(!i())throw new Error("createScriptTag is unsupported server side. This call should be wrapped in canUseDOM().");const a=document.createElement("script");return t&&(a.id=t),s&&a.setAttribute("class",s),r&&(a.onload=r),a.type="text/javascript",e&&(window&&window.trustedTypesURLValidation?a.src=window.trustedTypesURLValidation(e,"scriptSrcUrlPolicy"):a.src=e,a.async=n,a.crossOrigin=o),window&&window.NONCE_ID&&(a.nonce=window.NONCE_ID),a}(e,t,o,void 0,void 0,(()=>s(!0)));a.crossOrigin=void 0,a.onerror=r,n.prepend(a)}))}(t,n,s,o)),r,a)}catch(e){yt("Failed to download Static JS",11103,{scriptId:n,scriptSrc:t},bt.Alert)}}({id:"display-sdk",src:"https://acdn.adnxs.com/ast/ast.js",container:document.head,retryDelayMs:200,retryNumber:5})}()}();
        </script>
         <script nonce="" src="https://assets.msn.cn/staticsb/statics/latest/oneTrustCN/1.0/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="42e7c639-42ed-4e0f-936c-e7f2a5fcb01e" id="onetrust-sdk"></script>

<meta name="description" content="想要对 上海市 进行分钟级预测? Microsoft 天气 会跟踪所有情况，包括降水预测、天气预警、空气质量更新，甚至野火警报。">
<link rel="canonical" href="https://www.msn.cn/zh-cn/weather/forecast/in-%E4%B8%8A%E6%B5%B7%E5%B8%82?ocid=msedgntp"/>
<meta property=og:url content="https://www.msn.cn/zh-cn/weather/weathertoday/in-%E4%B8%8A%E6%B5%B7%E5%B8%82?loc=eyJsIjoi5LiK5rW35biCIiwiciI6IuS4iua1t%2BW4giIsImMiOiLkuK3ljY7kurrmsJHlhbHlkozlm70iLCJpIjoiQ04iLCJnIjoiemgtY24iLCJ4IjoiMTIxLjM4NzQ4OTMxODg0NzY2IiwieSI6IjMxLjI4NTIyMzAwNzIwMjE1In0%3D&amp;weadegreetype=C&amp;ocid=msedgntp&amp;cvid=66581f4a382b43799dfa5eb479e2caae&amp;callSsr=true">
<link rel="dns-prefetch" href="//img-s-msn-com.akamaized.net" crossorigin="use-credentials"><link rel="dns-prefetch" href="//sb.scorecardresearch.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="//th.bing.com" crossorigin="use-credentials"><link rel="preconnect" href="//img-s-msn-com.akamaized.net" crossorigin="use-credentials"><link rel="preconnect" href="//sb.scorecardresearch.com" crossorigin="use-credentials"><link rel="preconnect" href="//th.bing.com" crossorigin="use-credentials"><link rel="preconnect" href="//ecn.api.tiles.virtualearth.net" crossorigin="anonymous"><link rel="preconnect" href="//ecn.api.tiles.virtualearth.net" crossorigin="use-credentials"><link rel="preconnect" href="//t.ssl.ak.dynamic.tiles.virtualearth.net" crossorigin="anonymous"><link rel="preconnect" href="//t.ssl.ak.dynamic.tiles.virtualearth.net" crossorigin="use-credentials"><link rel="preconnect" href="//t.ssl.ak.tiles.virtualearth.net" crossorigin="use-credentials"><link rel="dns-prefetch" href="//api.msn.cn" crossorigin="use-credentials"><link rel="dns-prefetch" href="//assets.msn.cn" crossorigin="anonymous"><link rel="dns-prefetch" href="//assets.msn.cn" crossorigin="use-credentials"><link rel="dns-prefetch" href="//c.msn.cn" crossorigin="use-credentials"><link rel="preconnect" href="//api.msn.cn" crossorigin="use-credentials"><link rel="preconnect" href="//assets.msn.cn" crossorigin="anonymous"><link rel="preconnect" href="//assets.msn.cn" crossorigin="use-credentials"><link rel="preconnect" href="//c.msn.cn" crossorigin="use-credentials">
        <script type="text/javascript" nonce="">
            if(matchMedia("(prefers-color-scheme:dark)").matches){const s=document.createElement("style");document.head.appendChild(s);s.type="text/css";s.appendChild(document.createTextNode("body{background:#242424}"));}
        </script>


        <script type="text/javascript" nonce="">
        const _clientSettings = JSON.parse(document.head.dataset.clientSettings);

        </script>
    <script type="text/javascript" nonce="">
            function appendProtocolQSP(url){return url;}
        function appendScript(url,async,defer){let s=document.createElement("script");s.type="text/javascript";const w=window.trustedTypesURLValidation;s.src=appendProtocolQSP(w?w(url,"bundleUrlPolicy"):url);if(async){s.async=true;}if(defer){s.defer=true;}s.onerror=()=>onErrorHandler(s.src);s.nonce="";s.crossOrigin="anonymous";document.body.appendChild(s);}
    </script>
<a href="http://www.oreilly.com">O'Reilly Media</a>

</head>
